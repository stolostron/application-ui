FROM registry.access.redhat.com/ubi8/go-toolset:latest as builder
# get yq
RUN go get github.com/mikefarah/yq

# FROM cypress/included:6.2.1 as production
FROM quay.io/kcormier/cypress-included:latest as production

USER root

RUN mkdir -p /opt/app-root/src/application-ui
WORKDIR /opt/app-root/src/application-ui
COPY tests ./tests
WORKDIR /opt/app-root/src/application-ui/tests

RUN npm install 

RUN sh download-clis.sh

ENTRYPOINT ["./start-cypress-tests.sh"]

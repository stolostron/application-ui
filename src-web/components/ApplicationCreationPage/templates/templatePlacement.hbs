{{! ========================================================== }}
{{! ========================================================== }}
{{! ================== Placement ============================= }}
{{! ========================================================== }}
{{! ========================================================== }}

  placement:
{{#if local-cluster-checkbox}} 
    local: true
{{else}}
    placementRef:
      kind: PlacementRule
{{#if selectedRuleName}} 
      name: {{{selectedRuleName}}}
{{else}}       
      name: {{{@root.name}}}-placement-{{@index}}
{{/if}}       
{{/if}}
{{#if timeWindow.mode}}
  timewindow:
    windowtype: {{{timeWindow.mode}}}
    location: {{{timeWindow.timezone}}}
    weekdays: [{{{timeWindow.days}}}]
    {{#if timeWindow.showTimeSection}}
    hours:
      {{#each timeWindow.timeList}}
      {{#if validTime}}
      - start: "{{{start}}}"
        end: "{{{end}}}"
      {{/if}}
      {{/each}}
    {{/if}}
{{/if}}

{{#unless existingrule-checkbox}} 
{{#unless local-cluster-checkbox}}
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  labels:
    app: {{{@root.name}}}
  name: {{{@root.name}}}-placement-{{@index}}
  namespace: {{{@root.namespace}}}
{{#if clusterSelector.mode}}  
spec:
  {{#if clusterReplicas}}
  clusterReplicas: {{{clusterReplicas}}}
  {{/if}}  
  clusterSelector:
    matchLabels:
      {{#each clusterSelector.clusterLabelsList}}
      {{#if validValue}}
      {{{labelName}}}: '{{{labelValue}}}'
      {{/if}}
      {{/each}} 
  {{#if online-cluster-only-checkbox}}
  clusterConditions:
    - type: ManagedClusterConditionAvailable
      status: "True"
  {{/if}}
{{else}}
  {{#if online-cluster-only-checkbox}}
spec:
  {{#if clusterReplicas}}
  clusterReplicas: {{{clusterReplicas}}}
  {{/if}} 
  clusterConditions:
    - type: ManagedClusterConditionAvailable
      status: "True"
  {{else}} 
  {{#if clusterReplicas}}
spec:  
  clusterReplicas: {{{clusterReplicas}}}
  {{/if}}    
  {{/if}}
{{/if}}
{{/unless}}
{{/unless}}

